---
title: "tidy_script_6"
author: "Jocelyn Martinez Rico"
date: "3/18/2022"
output: 
  html_document:
    theme: yeti
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Introduction

Tidy Tuesday assignment #6 on baby names using data from 2022-03-22

# Load libraries
```{r}
library(tidyverse)
library(here)
library(rcartocolor)
library(showtext)
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
```

# Load data
```{r}
baby_names <- read_csv(here("Tidy_Tuesday_6/data","babynames.csv"))
View(baby_names)
glimpse(baby_names)
```

# Data wrangling
```{r}
baby_names %>%
  count(year, sort = TRUE) %>%
  arrange(desc(year))

two_baby <- baby_names %>%
  filter(year >= 2000) %>% #selects year range
  rename(record = n) #renames column

glimpse(two_baby)
view(two_baby)
```
```{r}
#data for girl plot
girl_baby <- two_baby %>%
  filter(sex == "F") %>% #filters for female
  slice_max(record, n = 10) #filters for top ten names

view(girl_baby)
glimpse(girl_baby)
```

```{r}
#data for boy plot

boy_baby <- two_baby %>%
  filter(sex == "M") %>% #filters for male
  slice_max(record, n = 10) #filters for top ten names

view(boy_baby)
glimpse(boy_baby)
```

# Plotting the data
```{r}
font_add(family = "baskerville", regular = "Baskerville.ttc")
showtext_auto()
```

```{r}
#girl plot

girl_plot <- girl_baby %>%
  ggplot(aes(x = year,
             y = record, 
             fill = name,
             color = name))+
  geom_point(size = 3)+
  scale_x_continuous(breaks = seq(2000, 2010, 1), #reorders x axis in increments of 1000
                     limits=c(2000, 2010))+ #creates limit for axis
  labs(x = "Year", #defines x axis
       y = "Name Count", #defines y axis
       color = "Name")+ 
  theme_bw()+ #b/w background
  theme(text = element_text(family = "baskerville"),
        axis.text.x = element_text(angle = 45, hjust=1))+
  scale_color_carto_d(name = "name", palette = "Magenta") #adds color to fill
girl_plot
```

```{r}
#boy plot
boy_plot <- boy_baby %>%
  ggplot(aes(x = year,
             y = record, 
             fill = name,
             color = name))+
  geom_point(size = 3)+
  scale_x_continuous(breaks = seq(2000, 2010, 1), #reorders x axis in increments of 1000
                     limits=c(2000, 2010))+ #creates limit for axis
  labs(x = "Year", #defines x axis
       y = "Name Count", #defines y axis
       caption = "Source: 2022-03-22 TidyTuesday Data Provided By US baby names / Haley Wickam")+ #adds caption
  theme_bw()+ #b/w background
  theme(text = element_text(family = "baskerville"),
        axis.text.x = element_text(angle = 45, hjust=1))+
  scale_color_carto_d(palette = "Teal") #adds color to fill
boy_plot
```

```{r}
girl_plot+boy_plot+
  plot_layout(guides = 'collect') #combines legend
```


